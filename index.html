
 <!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Painel de Requisi√ß√µes</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:20px; }
    table { border-collapse: collapse; width: 100%; margin-top:20px; }
    th, td { border:1px solid #ccc; padding:8px; text-align:left; }
    th { background:#007bff; color:white; }
    button { padding:6px 12px; margin:2px; cursor:pointer; }
  </style>
</head>
<body>

  <h1>Painel de Requisi√ß√µes - DEL√çCIA GOURMET</h1>

  <table>
    <thead>
      <tr>
        <th>Data</th><th>Item</th><th>Qtd</th><th>Unidade</th>
        <th>Setor</th><th>Solicitante</th><th>Obs</th><th>A√ß√£o</th>
      </tr>
    </thead>
    <tbody id="tabelaRequisicoes"></tbody>
  </table>

  <h2>üõí Carrinho</h2>
  <table>
    <thead>
      <tr><th>Item</th><th>Qtd</th><th>Unid</th><th>Setor</th><th>Solicitante</th></tr>
    </thead>
    <tbody id="tabelaCarrinho"></tbody>
  </table>
  <br>
  <button onclick="enviarCarrinho()">‚úÖ Salvar Carrinho na Planilha</button>

<script>
/* üîπ URLs separadas */
const URL_DADOS    = "https://script.google.com/macros/s/AKfycbwS0garmL7W-1qcAdt-iLXx-ibTdt62xuIdhUL7bHBVLUrNfjm41PklAc7YIEHnkyWCYQ/exec";
const URL_CARRINHO = "https://script.google.com/macros/s/AKfycbwS0garmL7W-1qcAdt-iLXx-ibTdt62xuIdhUL7bHBVLUrNfjm41PklAc7YIEHnkyWCYQ/exec";

let carrinho = [];

/* Carregar dados */
async function carregarDados(){
  const res = await fetch(URL_DADOS);
  const dados = await res.json();
  renderTabela(dados);
}

function renderTabela(dados){
  const tb = document.getElementById("tabelaRequisicoes");
  tb.innerHTML = "";
  dados.forEach(linha=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${linha[0]}</td>
      <td>${linha[1]}</td>
      <td>${linha[3]}</td>
      <td>${linha[2]}</td>
      <td>${linha[4]}</td>
      <td>${linha[5]}</td>
      <td>${linha[6]}</td>
      <td><button onclick='addCarrinho(${JSON.stringify(linha)})'>‚ûï</button></td>
    `;
    tb.appendChild(tr);
  });
}

function addCarrinho(linha){
  carrinho.push({
    dataHoraOriginal: linha[0],
    item: linha[1],
    unidade: linha[2],
    quantidade: linha[3],
    setor: linha[4],
    solicitante: linha[5],
    observacoes: linha[6],
    empresa: "DEL√çCIA GOURMET" // üîπ sempre salva o nome da empresa
  });
  atualizarCarrinho();
}

function atualizarCarrinho(){
  const tb = document.getElementById("tabelaCarrinho");
  tb.innerHTML = "";
  carrinho.forEach(it=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${it.item}</td><td>${it.quantidade}</td><td>${it.unidade}</td><td>${it.setor}</td><td>${it.solicitante}</td>`;
    tb.appendChild(tr);
  });
}

/* Enviar carrinho */
async function enviarCarrinho(){
  if(carrinho.length===0){ alert("Carrinho vazio!"); return; }
  const payload = { action:"registrar_requisicoes", empresa:"DEL√çCIA GOURMET", itens:carrinho };
  const res = await fetch(URL_CARRINHO,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify(payload)
  });
  const out = await res.json();
  if(out.ok){
    alert(`‚úÖ ${out.count} itens salvos na planilha!`);
    carrinho = [];
    atualizarCarrinho();
  }else{
    alert("Erro: "+out.error);
  }
}

carregarDados();
</script>
</body>
</html>
